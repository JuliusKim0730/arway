# ë‹¤ìŒ ì‘ì—… ì¤€ë¹„ ì™„ë£Œ

**ì‘ì„±ì¼**: 2025-12-22  
**ìƒíƒœ**: âœ… ì¤€ë¹„ ì™„ë£Œ

---

## âœ… ì¤€ë¹„ ì™„ë£Œ í•­ëª©

### 1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥

#### ìƒì„±ëœ í…Œì´ë¸” (`docs/CREATE_SCQ_TABLES.sql`)
- âœ… `geofences` - ì§€ì˜¤íœìŠ¤/ê±´ë¬¼ ê²½ê³„
- âœ… `geofence_entry_points` - ì§„ì…ì 
- âœ… `buildings` - ê±´ë¬¼ ì •ë³´
- âœ… `indoor_maps` - ì‹¤ë‚´ ë§µ
- âœ… `indoor_zones` - ì‹¤ë‚´ êµ¬ì—­
- âœ… `landmarks` - ëœë“œë§ˆí¬
- âœ… `pois` - Points of Interest

### 2. ë°±ì—”ë“œ ëª¨ë¸ ìƒì„±

#### ìƒì„±ëœ ëª¨ë¸ (`backend/app/models/`)
- âœ… `building.py` - Building ëª¨ë¸
- âœ… `geofence.py` - Geofence, GeofenceEntryPoint ëª¨ë¸
- âœ… `indoor_map.py` - IndoorMap, IndoorZone ëª¨ë¸
- âœ… `landmark.py` - Landmark ëª¨ë¸
- âœ… `poi.py` - POI ëª¨ë¸
- âœ… `models/__init__.py` ì—…ë°ì´íŠ¸ ì™„ë£Œ

### 3. ë°±ì—”ë“œ ìŠ¤í‚¤ë§ˆ ìƒì„±

#### ìƒì„±ëœ ìŠ¤í‚¤ë§ˆ (`backend/app/schemas/`)
- âœ… `geofence.py` - Geofence ìŠ¤í‚¤ë§ˆ
- âœ… `indoor_map.py` - IndoorMap ìŠ¤í‚¤ë§ˆ
- âœ… `poi.py` - POI ìŠ¤í‚¤ë§ˆ
- âœ… `schemas/__init__.py` ì—…ë°ì´íŠ¸ ì™„ë£Œ

### 4. ë°±ì—”ë“œ API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„

#### ìƒì„±ëœ API (`backend/app/api/v1/`)
- âœ… `geofences.py` - ì§€ì˜¤íœìŠ¤ API
  - `GET /api/v1/geofences` - ì§€ì˜¤íœìŠ¤ ëª©ë¡ ì¡°íšŒ
  - `GET /api/v1/geofences/{id}` - ì§€ì˜¤íœìŠ¤ ìƒì„¸ ì¡°íšŒ
- âœ… `indoor_maps.py` - ì‹¤ë‚´ ë§µ API
  - `GET /api/v1/indoor-maps` - ì‹¤ë‚´ ë§µ ëª©ë¡ ì¡°íšŒ
  - `GET /api/v1/indoor-maps/{id}` - ì‹¤ë‚´ ë§µ ìƒì„¸ ì¡°íšŒ
  - `GET /api/v1/indoor-maps/building/{building_id}` - ê±´ë¬¼ë³„ ì‹¤ë‚´ ë§µ ì¡°íšŒ
- âœ… `pois.py` - POI API
  - `GET /api/v1/pois` - POI ëª©ë¡ ì¡°íšŒ
  - `GET /api/v1/pois/{id}` - POI ìƒì„¸ ì¡°íšŒ
  - `GET /api/v1/pois/indoor/{indoor_map_id}/nearby` - ì‹¤ë‚´ POI ê·¼ì²˜ ê²€ìƒ‰
- âœ… `main.py`ì— ë¼ìš°í„° ë“±ë¡ ì™„ë£Œ

### 5. í”„ë¡ íŠ¸ì—”ë“œ API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„

#### ìƒì„±ëœ íŒŒì¼ (`frontend/lib/api/`)
- âœ… `scq.ts` - SCQ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
  - `fetchGeofences()` - ì§€ì˜¤íœìŠ¤ ì¡°íšŒ
  - `fetchIndoorMaps()` - ì‹¤ë‚´ ë§µ ì¡°íšŒ
  - `fetchIndoorMapDetail()` - ì‹¤ë‚´ ë§µ ìƒì„¸ ì¡°íšŒ
  - `fetchPOIs()` - POI ì¡°íšŒ
  - `fetchNearbyIndoorPOIs()` - ì‹¤ë‚´ POI ê·¼ì²˜ ê²€ìƒ‰

### 6. í”„ë¡ íŠ¸ì—”ë“œ React Hook êµ¬í˜„

#### ìƒì„±ëœ íŒŒì¼ (`frontend/hooks/`)
- âœ… `useSCQData.ts` - SCQ ë°ì´í„° ë¡œë“œ í›…
  - ìë™ìœ¼ë¡œ ì§€ì˜¤íœìŠ¤, ì‹¤ë‚´ ë§µ, POI ë¡œë“œ
  - í˜„ì¬ ìœ„ì¹˜ ê¸°ë°˜ í•„í„°ë§
  - ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ì²˜ë¦¬

---

## ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„ ì‘ì—… ëª©ë¡

### ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì‘ì—…

1. **ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜**
   ```sql
   -- Supabase Dashboard > SQL Editorì—ì„œ ì‹¤í–‰
   -- docs/CREATE_SCQ_TABLES.sql íŒŒì¼ ë‚´ìš© ì‹¤í–‰
   ```

2. **AR ë„¤ë¹„ê²Œì´ì…˜ í˜ì´ì§€ì— SCQ í†µí•©**
   ```tsx
   // frontend/app/ar-nav/run/page.tsxì— ì¶”ê°€
   import { SCQIntegration } from '@/components/SCQIntegration';
   import { useSCQData } from '@/hooks/useSCQData';
   
   const { geofences, pois } = useSCQData({
     currentLocation,
     buildingId: '...',
   });
   
   <SCQIntegration
     route={route}
     geofences={geofences}
     poiDatabase={pois}
     onIndoorModeChange={setIsIndoor}
     onARActionChange={setArAction}
   />
   ```

3. **í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±**
   - ì§€ì˜¤íœìŠ¤ ìƒ˜í”Œ ë°ì´í„°
   - ì‹¤ë‚´ ë§µ ìƒ˜í”Œ ë°ì´í„°
   - POI ìƒ˜í”Œ ë°ì´í„°

---

## ğŸ”§ ì‚¬ìš© ë°©ë²•

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
# Supabase Dashboard > SQL Editorì—ì„œ ì‹¤í–‰
# docs/CREATE_SCQ_TABLES.sql íŒŒì¼ ë‚´ìš© ë³µì‚¬í•˜ì—¬ ì‹¤í–‰
```

### 2. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°ì´í„° ë¡œë“œ

```tsx
import { useSCQData } from '@/hooks/useSCQData';

function MyComponent() {
  const { geofences, pois, loading } = useSCQData({
    currentLocation: { lat: 37.5665, lng: 126.9780 },
    buildingId: 'building-uuid',
  });
  
  return (
    <div>
      {loading && <p>Loading...</p>}
      {geofences.map(g => <div key={g.id}>{g.name}</div>)}
      {pois.map(p => <div key={p.id}>{p.name}</div>)}
    </div>
  );
}
```

### 3. ìˆ˜ë™ ë°ì´í„° ë¡œë“œ

```tsx
import { fetchGeofences, fetchPOIs } from '@/lib/api/scq';

const geofences = await fetchGeofences({
  lat: 37.5665,
  lng: 126.9780,
  radius: 1000,
});

const pois = await fetchPOIs({
  lat: 37.5665,
  lng: 126.9780,
  radius: 100,
});
```

---

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### Geofence
```typescript
{
  id: string;
  name: string;
  type: 'building' | 'indoor_zone' | 'outdoor_area';
  polygon: [{ lat: number; lng: number }, ...];
  entryPoints: [{ id: string; lat: number; lng: number; name: string }, ...];
}
```

### Indoor Map
```typescript
{
  id: string;
  building_id: string;
  floor: number;
  map_data: {
    zones: [...],
    landmarks: [...]
  };
}
```

### POI
```typescript
{
  id: string;
  name: string;
  type: 'store' | 'restaurant' | 'exhibit' | 'restroom' | 'exit' | ...;
  // ì‹¤ì™¸
  latitude?: number;
  longitude?: number;
  // ì‹¤ë‚´
  indoor_map_id?: string;
  position_x?: number;
  position_y?: number;
  floor?: number;
  priority: number; // 0-1
}
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° SQL ì‘ì„±
- [x] ë°±ì—”ë“œ ëª¨ë¸ ìƒì„±
- [x] ë°±ì—”ë“œ ìŠ¤í‚¤ë§ˆ ìƒì„±
- [x] ë°±ì—”ë“œ API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
- [x] í”„ë¡ íŠ¸ì—”ë“œ API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
- [x] í”„ë¡ íŠ¸ì—”ë“œ React Hook êµ¬í˜„
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
- [ ] í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
- [ ] AR ë„¤ë¹„ê²Œì´ì…˜ í˜ì´ì§€ì— SCQ í†µí•©

---

**ì¤€ë¹„ ì™„ë£Œì¼**: 2025-12-22  
**ë‹¤ìŒ ë‹¨ê³„**: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ë° í†µí•© í…ŒìŠ¤íŠ¸

