# 🔧 로컬 개발 환경 변수 설정 가이드

## 📋 개요

로컬 개발 환경에서 API 키가 없으면 다음과 같은 문제가 발생합니다:
- ❌ TMAP 지도가 로드되지 않음
- ❌ Google Maps 지도가 로드되지 않음
- ❌ 경로 계산 실패
- ⚠️ 직선 경로로만 동작 (기본 폴백)

**해결 방법**: `frontend/.env.local` 파일에 API 키를 설정하세요.

---

## 🚀 빠른 설정 (3단계)

### 1단계: 환경 변수 파일 생성

```powershell
cd frontend
copy .env.local.example .env.local
```

또는 수동으로 `frontend/.env.local` 파일 생성

### 2단계: API 키 입력

`frontend/.env.local` 파일을 열고 실제 API 키를 입력:

```env
# TMAP API 키 (한국 사용 시 필수)
NEXT_PUBLIC_TMAP_API_KEY=실제_TMAP_API_키

# Google Maps API 키 (해외 사용 시 필수)
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=실제_Google_Maps_API_키

# NextAuth 설정
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=랜덤_문자열

# 백엔드 API URL
NEXT_PUBLIC_API_URL=http://localhost:8000
```

### 3단계: 개발 서버 재시작

```powershell
# 프론트엔드 서버 중지 (Ctrl+C)
# 다시 시작
npm run dev
```

**중요**: 환경 변수 변경 후에는 반드시 서버를 재시작해야 합니다!

---

## 🔑 API 키 발급 방법

### TMAP API 키 발급

1. [TMAP API 포털](https://tmapapi.sktelecom.com/) 접속
2. 회원가입 및 로그인
3. "내 애플리케이션" → "앱 등록"
4. 앱 정보 입력 후 API 키 발급
5. 발급받은 키를 `NEXT_PUBLIC_TMAP_API_KEY`에 입력

### Google Maps API 키 발급

1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 프로젝트 생성 또는 선택
3. "APIs & Services" → "Credentials"
4. "+ 자격 증명 만들기" → "API 키"
5. 발급받은 키를 `NEXT_PUBLIC_GOOGLE_MAPS_API_KEY`에 입력
6. **중요**: API 제한 설정에서 "Maps JavaScript API"와 "Directions API" 활성화

---

## ⚙️ 환경 변수별 동작

### 시나리오 1: TMAP API 키만 있는 경우
- ✅ 한국: TMAP 지도 및 경로 사용
- ⚠️ 해외: Google Maps API 키 없어서 직선 경로만 사용

### 시나리오 2: Google Maps API 키만 있는 경우
- ⚠️ 한국: TMAP API 키 없어서 Google Maps 사용 (지역 락 가능)
- ✅ 해외: Google Maps 지도 및 경로 사용

### 시나리오 3: 둘 다 있는 경우 (권장)
- ✅ 한국: TMAP 사용
- ✅ 해외: Google Maps 사용
- ✅ 최적의 사용자 경험

### 시나리오 4: 둘 다 없는 경우 (테스트용)
- ⚠️ 지도: 표시되지 않음
- ⚠️ 경로: 직선 경로만 사용
- ✅ 기본 네비게이션 기능은 동작 (방향 화살표, 거리 표시)

---

## 🧪 테스트 방법

### API 키 설정 확인

브라우저 콘솔에서 확인:
```javascript
// 콘솔에 출력됨
console.log('TMAP API 키:', process.env.NEXT_PUBLIC_TMAP_API_KEY ? '설정됨' : '설정되지 않음');
console.log('Google Maps API 키:', process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY ? '설정됨' : '설정되지 않음');
```

### 지도 표시 확인

1. **TMAP 지도**: 한국 위치에서 TMAP 지도가 표시되는지 확인
2. **Google Maps 지도**: 해외 위치 또는 TMAP API 키가 없을 때 Google Maps가 표시되는지 확인

### 경로 계산 확인

1. 출발지와 도착지 설정
2. "AR 네비게이션 시작" 클릭
3. 콘솔에서 경로 계산 로그 확인:
   - ✅ "TMAP 경로 계산 성공" 또는 "Google Maps 경로 계산 성공"
   - ⚠️ "직선 경로 모드로 전환됨" (API 키 없을 때)

---

## 🐛 문제 해결

### 환경 변수가 적용되지 않음

**증상**: API 키를 설정했는데도 "설정되지 않음"으로 표시됨

**해결**:
1. 파일명 확인: `.env.local` (앞에 점 포함)
2. 파일 위치 확인: `frontend/.env.local` (프론트엔드 폴더 내)
3. 서버 재시작: 환경 변수 변경 후 반드시 재시작
4. 빌드 캐시 삭제:
   ```powershell
   cd frontend
   rm -rf .next
   npm run dev
   ```

### API 키가 노출됨

**주의**: `.env.local` 파일은 `.gitignore`에 포함되어 있어야 합니다!

**확인**:
```powershell
# .gitignore 파일 확인
cat frontend/.gitignore | findstr .env.local
```

---

## 📝 체크리스트

로컬 개발 환경 설정:
- [ ] `frontend/.env.local` 파일 생성
- [ ] TMAP API 키 설정 (한국 사용 시)
- [ ] Google Maps API 키 설정 (해외 사용 시)
- [ ] NextAuth 설정 (로그인 사용 시)
- [ ] 백엔드 API URL 설정
- [ ] 개발 서버 재시작
- [ ] 브라우저 콘솔에서 API 키 확인
- [ ] 지도 표시 확인
- [ ] 경로 계산 확인

---

## 💡 팁

### 프로덕션과 개발 환경 분리

- **로컬 개발**: `.env.local` 파일 사용
- **Vercel 배포**: Vercel 대시보드에서 환경 변수 설정
- **Render 배포**: Render 대시보드에서 환경 변수 설정

### API 키 없이 테스트하기

API 키가 없어도 기본 기능은 동작합니다:
- ✅ GPS 위치 추적
- ✅ 방향 화살표 표시
- ✅ 직선 거리 계산
- ⚠️ 지도 표시 안 됨
- ⚠️ 경로 계산 안 됨 (직선 경로만)

---

## 🔗 참고 링크

- [TMAP API 포털](https://tmapapi.sktelecom.com/)
- [Google Maps API 문서](https://developers.google.com/maps/documentation)
- [Next.js 환경 변수 문서](https://nextjs.org/docs/basic-features/environment-variables)

