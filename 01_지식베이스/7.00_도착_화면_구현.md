---
title: "7.00 ë„ì°© í™”ë©´ êµ¬í˜„"
type: "implementation"
tags: ["frontend", "nextjs", "react", "ui", "feedback"]
dependencies: ["nextjs", "react", "typescript"]
---

# 7.00 ë„ì°© í™”ë©´ êµ¬í˜„

## ì›Œí¬í”Œë¡œìš° ê°œìš”

ë„¤ë¹„ê²Œì´ì…˜ ì™„ë£Œ í›„ ë„ì°© í™”ë©´ì„ êµ¬í˜„í•˜ê³ , ì‚¬ìš©ì í”¼ë“œë°±ì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤.

## ëª©í‘œ

- ë„ì°© ì™„ë£Œ ë©”ì‹œì§€ í‘œì‹œ
- í”¼ë“œë°± ìˆ˜ì§‘ UI êµ¬í˜„
- ì„¸ì…˜ ì¢…ë£Œ ì²˜ë¦¬
- ì¬ì‹œì‘ ì˜µì…˜ ì œê³µ

## ë‹¨ê³„ë³„ ì‘ì—…

### 7.1 ë„ì°© í™”ë©´ í˜ì´ì§€

#### 7.1.1 ë©”ì¸ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
`frontend/app/ar-nav/arrived/page.tsx`:
```typescript
'use client';

import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { submitFeedback, updateSession } from '@/lib/api';
import { useNavigationStore } from '@/store/navigationStore';

export default function ArNavArrivedPage() {
  const router = useRouter();
  const { currentSessionId, clearNavigation } = useNavigationStore();
  const [rating, setRating] = useState<number | null>(null);
  const [comment, setComment] = useState('');
  const [submitted, setSubmitted] = useState(false);

  useEffect(() => {
    // ì„¸ì…˜ ì¢…ë£Œ ì²˜ë¦¬
    if (currentSessionId) {
      completeSession();
    }
  }, [currentSessionId]);

  const completeSession = async () => {
    if (!currentSessionId) return;

    try {
      await updateSession(currentSessionId, {
        status: 'completed',
      });
    } catch (err) {
      console.error('ì„¸ì…˜ ì¢…ë£Œ ì‹¤íŒ¨:', err);
    }
  };

  const handleFeedback = async (selectedRating: number) => {
    setRating(selectedRating);
    
    if (!currentSessionId) return;

    try {
      // í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ì ID
      const userId = 'test-user-id';
      
      await submitFeedback({
        session_id: currentSessionId,
        user_id: userId,
        rating: selectedRating,
        comment: comment || undefined,
      });
      
      setSubmitted(true);
    } catch (err) {
      console.error('í”¼ë“œë°± ì œì¶œ ì‹¤íŒ¨:', err);
    }
  };

  const handleRestart = () => {
    clearNavigation();
    router.push('/ar-nav/select');
  };

  const handleGoHome = () => {
    clearNavigation();
    router.push('/ar-nav');
  };

  return (
    <div className="min-h-screen bg-gray-900 text-white flex flex-col">
      {/* í—¤ë” */}
      <header className="p-6 text-center">
        <h1 className="text-2xl font-semibold">ì•ˆë‚´ ì™„ë£Œ</h1>
      </header>

      {/* ì„±ê³µ ë©”ì‹œì§€ */}
      <main className="flex-1 flex flex-col items-center justify-center px-6">
        <div className="text-center space-y-6">
          <div className="text-6xl mb-4">ğŸ‰</div>
          <h2 className="text-3xl font-bold">ë„ì°©í–ˆìŠµë‹ˆë‹¤!</h2>
          <p className="text-lg text-gray-400">
            AR ë„¤ë¹„ê°€ ëª©ì ì§€ê¹Œì§€ ì•ˆë‚´ë¥¼ ì™„ë£Œí–ˆì–´ìš”.
          </p>
        </div>
      </main>

      {/* í”¼ë“œë°± ì„¹ì…˜ */}
      {!submitted ? (
        <div className="px-6 pb-6 space-y-6">
          <div className="text-center">
            <p className="text-lg mb-4">ì´ ì•ˆë‚´ëŠ” ë„ì›€ì´ ë˜ì—ˆë‚˜ìš”?</p>
            <div className="flex justify-center gap-4">
              <button
                onClick={() => handleFeedback(5)}
                className={`text-4xl p-4 rounded-full transition-transform ${
                  rating === 5 ? 'scale-110' : 'hover:scale-105'
                }`}
              >
                ğŸ˜ƒ
              </button>
              <button
                onClick={() => handleFeedback(3)}
                className={`text-4xl p-4 rounded-full transition-transform ${
                  rating === 3 ? 'scale-110' : 'hover:scale-105'
                }`}
              >
                ğŸ˜
              </button>
              <button
                onClick={() => handleFeedback(1)}
                className={`text-4xl p-4 rounded-full transition-transform ${
                  rating === 1 ? 'scale-110' : 'hover:scale-105'
                }`}
              >
                ğŸ˜
              </button>
            </div>
          </div>

          {rating && (
            <div className="space-y-2">
              <label className="block text-sm text-gray-400">
                ì¶”ê°€ ì˜ê²¬ (ì„ íƒì‚¬í•­)
              </label>
              <textarea
                value={comment}
                onChange={(e) => setComment(e.target.value)}
                className="w-full bg-gray-800 text-white p-3 rounded-lg border border-gray-700 focus:border-blue-500 focus:outline-none"
                rows={3}
                placeholder="ì˜ê²¬ì„ ì…ë ¥í•´ì£¼ì„¸ìš”..."
              />
            </div>
          )}
        </div>
      ) : (
        <div className="px-6 pb-6 text-center">
          <p className="text-green-400 mb-4">í”¼ë“œë°±ì„ ê°ì‚¬í•©ë‹ˆë‹¤!</p>
        </div>
      )}

      {/* í•˜ë‹¨ ë²„íŠ¼ */}
      <div className="p-6 space-y-3">
        <button
          onClick={handleRestart}
          className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
        >
          ë‹¤ì‹œ ì•ˆë‚´ ë°›ê¸°
        </button>
        <Link
          href="/ar-nav"
          onClick={handleGoHome}
          className="block w-full bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 px-4 rounded-lg transition-colors text-center"
        >
          ì²˜ìŒìœ¼ë¡œ
        </Link>
      </div>
    </div>
  );
}
```

### 7.2 API í•¨ìˆ˜ ì¶”ê°€

#### 7.2.1 í”¼ë“œë°± ë° ì„¸ì…˜ ì—…ë°ì´íŠ¸ API
`frontend/lib/api.ts`ì— ì¶”ê°€:
```typescript
export async function submitFeedback(data: {
  session_id: string;
  user_id: string;
  rating: number;
  comment?: string;
}) {
  const response = await fetch(`${API_URL}/api/v1/feedback/`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
  });
  if (!response.ok) {
    throw new Error('Failed to submit feedback');
  }
  return response.json();
}

export async function updateSession(
  sessionId: string,
  data: {
    status?: string;
    end_latitude?: number;
    end_longitude?: number;
    total_distance?: number;
  }
) {
  const response = await fetch(`${API_URL}/api/v1/sessions/${sessionId}`, {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
  });
  if (!response.ok) {
    throw new Error('Failed to update session');
  }
  return response.json();
}
```

### 7.3 ë°±ì—”ë“œ í”¼ë“œë°± API êµ¬í˜„

#### 7.3.1 í”¼ë“œë°± ë¼ìš°í„°
`backend/app/api/v1/feedback.py`:
```python
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from typing import List
from app.database import get_db
from app import models, schemas

router = APIRouter()

@router.post("/", response_model=schemas.feedback.FeedbackResponse)
def create_feedback(
    feedback: schemas.feedback.FeedbackCreate,
    db: Session = Depends(get_db)
):
    db_feedback = models.Feedback(**feedback.dict())
    db.add(db_feedback)
    db.commit()
    db.refresh(db_feedback)
    return db_feedback

@router.get("/session/{session_id}", response_model=List[schemas.feedback.FeedbackResponse])
def get_session_feedback(session_id: str, db: Session = Depends(get_db)):
    feedbacks = db.query(models.Feedback).filter(
        models.Feedback.session_id == session_id
    ).all()
    return feedbacks
```

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë„ì°© ì™„ë£Œ ë©”ì‹œì§€ í‘œì‹œ ì™„ë£Œ
- [ ] í”¼ë“œë°± UI êµ¬í˜„ ì™„ë£Œ
- [ ] í”¼ë“œë°± ì œì¶œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ
- [ ] ì„¸ì…˜ ì¢…ë£Œ ì²˜ë¦¬ ì™„ë£Œ
- [ ] ì¬ì‹œì‘ ë²„íŠ¼ ë™ì‘ í™•ì¸
- [ ] í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ ë™ì‘ í™•ì¸
- [ ] ìƒíƒœ ê´€ë¦¬ ì´ˆê¸°í™” ì™„ë£Œ

## ë‹¤ìŒ ë‹¨ê³„

ë‹¤ìŒ ì›Œí¬í”Œë¡œìš°: **8.00 Admin ê´€ë¦¬ì í™”ë©´ êµ¬í˜„**

## ì°¸ê³  ìë£Œ

- Next.js ë¼ìš°íŒ…: https://nextjs.org/docs/app/building-your-application/routing
- React ìƒíƒœ ê´€ë¦¬: https://react.dev/learn/managing-state

