# 🗺️ TMAP 네비게이션 시스템 가이드

## 🎯 완성된 기능

### ✅ 자동 지역 감지
- GPS 좌표로 한국/해외 자동 판별
- 한국: TMAP API 사용
- 해외: Google Maps API 사용

### ✅ TMAP 지도 통합
- TMAP JavaScript API v2 사용
- 실시간 지도 표시
- 마커 및 경로 표시

### ✅ 완전한 네비게이션 플로우
1. **메인 화면**: 위치 권한 요청 및 상태 확인
2. **지도 화면**: 시작점/도착점 설정
3. **경로 검색**: TMAP/Google Maps API 호출
4. **AR 네비게이션**: 실제 네비게이션 실행

### ✅ 에러 처리 시스템
- 3번 실패 시 자동 중단
- 이전 화면으로 자동 복귀
- 상세한 에러 메시지 제공

## 🚀 사용 방법

### 1. 앱 실행
```bash
npm start
# 또는
yarn start
```

### 2. 브라우저에서 접속
- http://localhost:3000
- 홈 화면에서 "🗺️ TMAP 네비게이션 (신규)" 버튼 클릭

### 3. 위치 권한 허용
- 브라우저에서 위치 권한 요청 시 "허용" 클릭
- GPS 신호 수신까지 대기

### 4. 네비게이션 시작
- "🚀 네비게이션 시작" 버튼 클릭
- TMAP 지도 로딩 대기

### 5. 경로 설정
#### 출발지 설정
- 지도 클릭으로 출발지 설정
- 또는 "내 위치" 버튼으로 현재 위치 사용

#### 도착지 설정
- 지도 클릭으로 도착지 설정
- 녹색(출발지), 빨간색(도착지) 마커 확인

### 6. 길찾기 실행
- "🗺️ 길찾기 시작" 버튼 클릭
- 경로 검색 결과 확인
- "🚀 AR 네비게이션 시작" 버튼으로 AR 모드 진입

## 🔧 API 키 설정

### 환경변수 설정 (.env.local)
```env
REACT_APP_TMAP_API_KEY=l7xx1234567890abcdef1234567890abcdef12
REACT_APP_GOOGLE_MAPS_API_KEY=AIzaSy-your-google-maps-api-key
```

### 클라우드 배포 시
- **Vercel**: Settings → Environment Variables
- **Render**: Environment 탭에서 설정

## 🌍 지역별 API 사용

### 🇰🇷 한국 (TMAP API)
```
위경도 범위:
- 위도: 33.0 ~ 38.9
- 경도: 124.5 ~ 131.9
- 독도 포함: 37.2~37.3, 131.8~131.9
```

**특징:**
- 정확한 도보 경로
- 실시간 교통 정보
- 상세한 길안내
- 대중교통 연계

### 🌍 해외 (Google Maps API)
```
한국 범위 외 모든 지역
```

**특징:**
- 전 세계 지원
- 다양한 이동 수단
- 실시간 경로 업데이트
- 글로벌 POI 정보

## ⚠️ 에러 처리 시스템

### 3단계 에러 처리
1. **1차 실패**: 재시도 가능 (1/3)
2. **2차 실패**: 재시도 가능 (2/3)
3. **3차 실패**: 자동 중단 → 이전 화면 복귀

### 에러 유형별 처리
- **API 키 오류**: 설정 안내 메시지
- **네트워크 오류**: 재시도 안내
- **GPS 오류**: 위치 권한 재요청
- **경로 없음**: 다른 목적지 선택 안내

## 📱 모바일 최적화

### 터치 인터페이스
- 지도 터치로 위치 설정
- 핀치 줌/팬 지원
- 반응형 UI

### GPS 최적화
- 고정밀 GPS 필터링
- 실시간 위치 추적
- 배터리 효율성 고려

## 🔄 플로우 다이어그램

```
메인 화면
    ↓ (위치 권한 확인)
지도 화면
    ↓ (출발지 설정)
    ↓ (도착지 설정)
경로 검색
    ↓ (성공)
AR 네비게이션
    
    ↓ (3번 실패)
이전 화면 복귀
```

## 🧪 테스트 시나리오

### 기본 기능 테스트
1. **위치 권한**: 허용/거부 시나리오
2. **지역 감지**: 한국/해외 좌표 테스트
3. **지도 조작**: 클릭, 줌, 팬 테스트
4. **경로 검색**: 성공/실패 시나리오

### 에러 처리 테스트
1. **API 키 없음**: 에러 메시지 확인
2. **네트워크 오류**: 재시도 로직 확인
3. **3번 실패**: 자동 복귀 확인

### 모바일 테스트
1. **iOS Safari**: 터치 및 GPS 테스트
2. **Android Chrome**: 권한 및 성능 테스트

## 📊 성능 최적화

### API 로딩 최적화
- Google Maps API 동적 로딩
- TMAP API 지연 로딩
- 불필요한 API 호출 방지

### 메모리 관리
- 지도 인스턴스 정리
- 이벤트 리스너 해제
- 컴포넌트 언마운트 시 정리

## 🔐 보안 고려사항

### API 키 보호
- 환경변수 사용
- 도메인 제한 설정
- 사용량 모니터링

### 위치 정보 보호
- 필요 시에만 위치 요청
- 정확도 수준 조절
- 사용자 동의 확인

## 🎉 완성된 기능 요약

✅ **TMAP API 연결 완료**
✅ **지도 표시 및 조작**
✅ **시작점/도착점 설정**
✅ **내 위치 찾기**
✅ **길찾기 프로세스**
✅ **3번 실패 시 자동 중단**
✅ **이전 화면 복귀**
✅ **에러 추적 시스템**
✅ **모바일 최적화**

이제 TMAP API 키만 설정하면 완전한 네비게이션 시스템을 사용할 수 있습니다!